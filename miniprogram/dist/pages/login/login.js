"use strict";(wx["webpackJsonp"]=wx["webpackJsonp"]||[]).push([[817],{9877:function(s,e,a){var n=a(8870),t=a(4705),c=a(6540),i=a(118),o=a(758),r=a.n(o),l=a(4848);class h extends c.Component{constructor(){super(...arguments),(0,t.A)(this,"handleWeChatLogin",async()=>{try{const s=await r().getUserProfile({desc:"\u7528\u4e8e\u5b8c\u5584\u7528\u6237\u8d44\u6599"}),e=await r().login();if(e.code){const a=await r().request({url:"https://aimusic.sale/api/auth/wechat",method:"POST",data:{code:e.code,userInfo:s.userInfo}});a.data.success?(r().setStorageSync("userInfo",a.data.data),r().setStorageSync("token",a.data.data.token),r().showToast({title:"\u767b\u5f55\u6210\u529f",icon:"success"}),setTimeout(()=>{r().switchTab({url:"/pages/index/index"})},1500)):r().showToast({title:a.data.message||"\u767b\u5f55\u5931\u8d25",icon:"error"})}}catch(s){console.error("\u767b\u5f55\u5931\u8d25:",s),r().showToast({title:"\u767b\u5f55\u5931\u8d25\uff0c\u8bf7\u91cd\u8bd5",icon:"error"})}}),(0,t.A)(this,"goBack",()=>{r().navigateBack()})}render(){return(0,l.jsxs)(i.Ss,{className:"login",children:[(0,l.jsxs)(i.Ss,{className:"login-header",children:[(0,l.jsx)(i.EY,{className:"login-title",children:"\u6b22\u8fce\u4f7f\u7528"}),(0,l.jsx)(i.EY,{className:"login-subtitle",children:"\u4e3a\u7231\u800c\u6b4c"}),(0,l.jsx)(i.EY,{className:"login-desc",children:"\u4f7f\u7528\u5fae\u4fe1\u767b\u5f55\uff0c\u5f00\u59cb\u521b\u4f5c\u4e13\u5c5e\u60c5\u6b4c"})]}),(0,l.jsxs)(i.Ss,{className:"login-content",children:[(0,l.jsx)(i.Ss,{className:"login-icon",children:(0,l.jsx)(i.EY,{className:"wechat-icon",children:"\ud83d\udc9a"})}),(0,l.jsx)(i.$n,{className:"btn-primary wechat-login-btn",onClick:this.handleWeChatLogin,children:"\u5fae\u4fe1\u6388\u6743\u767b\u5f55"}),(0,l.jsxs)(i.Ss,{className:"login-tips",children:[(0,l.jsx)(i.EY,{className:"tips-text",children:"\u9996\u6b21\u4f7f\u7528\u5c06\u81ea\u52a8\u521b\u5efa\u8d26\u6237"}),(0,l.jsx)(i.EY,{className:"tips-text",children:"\u6211\u4eec\u627f\u8bfa\u4fdd\u62a4\u60a8\u7684\u9690\u79c1\u4fe1\u606f"})]})]}),(0,l.jsx)(i.Ss,{className:"login-footer",children:(0,l.jsx)(i.$n,{className:"btn-secondary back-btn",onClick:this.goBack,children:"\u8fd4\u56de\u9996\u9875"})})]})}}var d={navigationBarTitleText:"\u5fae\u4fe1\u767b\u5f55"},g=(0,n.eU)(h,"pages/login/login",{root:{cn:[]}},d||{});h&&h.behaviors&&(g.behaviors=(g.behaviors||[]).concat(h.behaviors));Page(g)}},function(s){var e=function(e){return s(s.s=e)};s.O(0,[907,96],function(){return e(9877)});s.O()}]);